<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mercy-sound</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    /* Ensure all cards in a row have equal height */
    .card {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .card-body {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      flex-grow: 1;
    }
    .heroRow {
      display: flex;
      align-items: stretch; /* Make sidebar height match left column */
    }
    #quickLink {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
  </style>
</head>
<body onload="onloadPage()">
  <div class="container wrapper">
    <!-- navbar -->
    <div class="header">
      <h1 class="fw-bolder text-center text-warning">MERCYSOUND</h1>
      <hr class="my-0">
      <ul class="nav justify-content-center fs-5 my-0">
        <li class="nav-item"><a class="nav-link active fw-bold" href="#">Music</a></li>
        <li class="nav-item"><a class="nav-link active fw-bold" href="#">Education</a></li>
        <li class="nav-item"><a class="nav-link active fw-bold" href="#">Articles</a></li>
        <li class="nav-item"><a class="nav-link active fw-bold" href="#">Contact Us</a></li>
        <li class="nav-item"><a class="nav-link active" href="#searchMusicInp">Search for Song</a></li>
      </ul>
      <hr class="my-0">
    </div>

    <!-- hero page -->
    <div class="heroBody mt-5">
      <div class="row heroRow">
        <!-- Main songs section -->
        <div class="col-sm-12 col-lg-8 col-xl-8">
          <p class="display-5 fw-normal">Pop Songs</p>
          <h5 id="aboutSong" class="fw-normal">
            <small></small>
            Below is a list of the <span class="text-primary">Latest Hippop Songs and Slow beat Songs mp3 download including 2019 / 2020. Latest Nigerian pop music, South African pop <span class="text-dark">and other</span> foreign pop songs.</span>
          </h5>
          <h4 id="songResult" class="rounded border-2"></h4>
          <div class="container-fluid" id="bodyRow"></div>

          <!-- Pagination -->
          <div class="m-3 d-flex gap-1 flex-wrap" id="pagination"></div>
        </div>

        <!-- Sidebar / Quick Links -->
        <div class="col-sm-12 col-lg-4 col-xl-4">
          <div class="p-2 h-100 d-flex flex-column">
            <div id="searchMusicInp" class="inp-btn d-flex mb-3">
              <input type="text" placeholder="Search Mercysound" class="form-control me-2 rounded-0" id="inpSong">
              <button class="btn btn-primary btn-md rounded-0 p-2" onclick="searchSong()">Search</button>
            </div>
            <div id="quickLink" class="quickLink border p-2 rounded">
              <h3>Quick Links</h3>
              <ul class="mt-3 fs-5 gap-3 d-grid row-gap-1">
                <li><a href="#" class="text-decoration-none">Mercy Chinwo Songs</a></li>
                <li><a href="#" class="text-decoration-none">Nathaniel Bassey Songs</a></li>
                <li><a href="#" class="text-decoration-none">Frank Edwards Songs</a></li>
                <li><a href="#" class="text-decoration-none">American Gospel Songs</a></li>
                <li><a href="#" class="text-decoration-none">Moses Bliss Songs</a></li>
                <li><a href="#" class="text-decoration-none">Sinach Songs</a></li>
                <li><a href="#" class="text-decoration-none">Nigerian Gospel Songs</a></li>
                <li><a href="#" class="text-decoration-none">Foreign Gospel Songs</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    let allSongs = [];
    let currentPage = 0;
    const songsPerPage = 6;

    // Placeholder loading cards
    const cardLoadFunc = () => {
      let placeholder = "<div class='row'>";
      for (let i = 0; i < songsPerPage; i++) {
        placeholder += `
          <div class='col-md-6 col-lg-4 p-1'>
            <div class="card" aria-hidden="true" style="height:300px;">
              <img src="..." class="card-img-top" alt="...">
              <div class="card-body">
                <h5 class="card-title placeholder-glow"><span class="placeholder col-6"></span></h5>
                <p class="card-text placeholder-glow">
                  <span class="placeholder col-7"></span>
                  <span class="placeholder col-4"></span>
                  <span class="placeholder col-4"></span>
                </p>
                <a class="btn btn-primary disabled placeholder col-6" aria-disabled="true"></a>
              </div>
            </div>
          </div>
        `;
      }
      placeholder += "</div>";
      bodyRow.innerHTML = placeholder;
    }

    const onloadPage = () => {
      cardLoadFunc();
      fetch("https://robo-music-api.onrender.com/music/my-api")
        .then(res => res.json())
        .then(data => {
          allSongs = data;
          currentPage = 0;
          renderPage(currentPage);
          renderPagination();
        });
    }

    const renderPage = (page) => {
      cardLoadFunc();
      const start = page * songsPerPage;
      const end = start + songsPerPage;
      const songsToShow = allSongs.slice(start, end);

      let content = "<div class='row'>";
      songsToShow.forEach(song => {
        content += `
          <div class='col-md-6 col-lg-4 p-1'>
            <div class="card h-100">
              <img src="${song.songImage}" class="card-img-top" style="height:200px; object-fit:cover;">
              <div class="card-body d-flex flex-column justify-content-between">
                <div class="mb-auto">
                  <h6>Song Titles: ${song.songTitle}</h6>
                  <h6>Artist Name: ${song.artistName}</h6>
                  <p class="mb-0">Date Release: ${song.releaseDate}</p>
                </div>
                <audio src="${song.songUrl}" controls class="w-100 mt-2"></audio>
              </div>
            </div>
          </div>
        `;
      });
      content += "</div>";
      bodyRow.innerHTML = content;
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    const renderPagination = () => {
      const totalPages = Math.ceil(allSongs.length / songsPerPage);
      let paginationHTML = "";
      for (let i = 0; i < totalPages; i++) {
        paginationHTML += `<button class="btn btn-light text-primary btn-outline-info" onclick="goToPage(${i})">${i+1}</button>`;
      }
      paginationHTML += `<button class="btn btn-light text-primary btn-outline-info" onclick="nextPage()">Next</button>`;
      document.getElementById("pagination").innerHTML = paginationHTML;
    }

    const goToPage = (page) => {
      currentPage = page;
      renderPage(currentPage);
    }

    const nextPage = () => {
      const totalPages = Math.ceil(allSongs.length / songsPerPage);
      if(currentPage < totalPages - 1){
        currentPage++;
        renderPage(currentPage);
      }
    }

    const searchSong = () => {
      const query = inpSong.value.toLowerCase();
      const results = allSongs.filter(song => song.songTitle.toLowerCase().includes(query));

      if(results.length === 0) {
        songResult.innerHTML = `No results found for "${inpSong.value}"`;
      } else if(results.length === 1) {
        songResult.innerHTML = `Search song result: "${inpSong.value}"`;
      } else {
        songResult.innerHTML = `Search songs results: "${inpSong.value}"`;
      }

      let content = "<div class='row'>";
      results.forEach(song => {
        content += `
          <div class='col-md-6 col-lg-4 p-1'>
            <div class="card h-100">
              <img src="${song.songImage}" class="card-img-top" style="height:200px; object-fit:cover;">
              <div class="card-body d-flex flex-column justify-content-between">
                <div class="mb-auto">
                  <h6>Song Titles: ${song.songTitle}</h6>
                  <h6>Artist Name: ${song.artistName}</h6>
                  <p class="mb-0">Date Release: ${song.releaseDate}</p>
                </div>
                <audio src="${song.songUrl}" controls class="w-100 mt-2"></audio>
              </div>
            </div>
          </div>
        `;
      });
      content += "</div>";
      bodyRow.innerHTML = content;
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  </script>
</body>
</html>
